---
# Various macOS Settings
# This file orchestrates various macOS configuration tasks

# Finder Configuration
- name: Import Finder settings
  ansible.builtin.import_tasks: ../finder.yml
  tags: ['finder']

# System Configuration
- name: Import System settings
  ansible.builtin.import_tasks: ../system.yml
  tags: ['system']

# LaunchAgents
- name: LaunchAgents
  include_tasks: "_launchagents.yml"
  loop: "{{ (unload_launchagents | default([])) + (private_mac_launchagents | default([])) + (launch_agents_to_disable | default([])) }}"
  loop_control:
    loop_var: agent
  tags: ['launchagents']

# macOS Defaults (generic loop from defaults.yml config)
- name: Set macOS default settings
  community.general.osx_defaults:
    domain: "{{ default_setting['domain'] }}"
    key: "{{ default_setting['key'] }}"
    type: "{{ default_setting['type'] | default(omit) }}"
    value: "{{ default_setting['value'] }}"
  become: "{{ default_setting['become'] | default(omit) }}"
  loop: "{{ defaults }}"
  loop_control:
    loop_var: default_setting
    label: "{{ default_setting['name'] }}"

# Maintenance Tasks
- name: Import Maintenance tasks
  ansible.builtin.import_tasks: ../maintenance.yml
  tags: ['maintenance']
